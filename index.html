<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>🕯️ Тайный Шифратор</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #fef9c3;
    }
    .hidden-area {
      display: none;
    }
    .typewriter-output {
      white-space: pre-wrap;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-6">

  <div id="loginArea" class="bg-white p-6 rounded-3xl shadow-lg w-full max-w-lg text-center space-y-4">
    <h1 class="text-2xl font-bold text-purple-700">🔒 Доступ по паролю</h1>
    <input id="username" type="text" placeholder="Имя..." class="w-full p-3 rounded-xl border border-purple-300">
    <input id="password" type="password" placeholder="Пароль..." class="w-full p-3 rounded-xl border border-purple-300">
    <button onclick="checkAccess()" class="bg-purple-600 text-white px-6 py-2 rounded-full font-bold">Войти</button>
    <p id="error" class="text-red-500 hidden">Неверно 🫢</p>
  </div>

  <div id="app" class="hidden-area bg-white p-6 rounded-xl shadow-xl mt-8 w-full max-w-3xl">
    <h1 class="text-3xl text-center mb-6 text-purple-800 font-bold">🪄 Шифратор</h1>
    <textarea id="inputText" rows="4" class="w-full p-3 border border-yellow-400 rounded-xl mb-4" placeholder="Введите сообщение..."></textarea>
    <div class="flex justify-center gap-4">
      <button onclick="encode()" class="bg-yellow-500 text-white px-6 py-2 rounded-full">✍️ Написать</button>
      <button onclick="decode()" class="bg-green-500 text-white px-6 py-2 rounded-full">📖 Прочитать</button>
    </div>
    <div id="outputText" class="mt-4 typewriter-output text-lg text-purple-900 min-h-[4rem]"></div>
  </div>

  <script>
    function reveal(encoded) {
      const map = {
        '∆':'A','¥':'B','₡':'C','Þ':'D','Σ':'E','₣':'F','Ǥ':'G','Ḩ':'H','ł':'I','Ĵ':'J',
        'Ҡ':'K','Ⱡ':'L','₥':'M','₦':'N','Ø':'O','₱':'P','Ǫ':'Q','Ŗ':'R','₴':'S','₮':'T',
        'Ʊ':'U','Ṽ':'V','Ŵ':'W','Ӿ':'X','Ɏ':'Y','Ȥ':'Z','~':'=','*':'+','_':'/'
      };
      let restored = encoded.split('').map(c => Object.entries(map).find(([k]) => k === c)?.[1] || c).join('');
      return JSON.parse(atob(restored));
    }

    function revealStr(encoded) {
      const map = {
        '∆':'A','¥':'B','₡':'C','Þ':'D','Σ':'E','₣':'F','Ǥ':'G','Ḩ':'H','ł':'I','Ĵ':'J',
        'Ҡ':'K','Ⱡ':'L','₥':'M','₦':'N','Ø':'O','₱':'P','Ǫ':'Q','Ŗ':'R','₴':'S','₮':'T',
        'Ʊ':'U','Ṽ':'V','Ŵ':'W','Ӿ':'X','Ɏ':'Y','Ȥ':'Z','~':'=','*':'+','_':'/'
      };
      let restored = encoded.split('').map(c => Object.entries(map).find(([k]) => k === c)?.[1] || c).join('');
      return atob(restored);
    }

    const encLogin = "R_Ɏ_¥₣₣₴";
    const encPass = "₥ØŖØǤ₥Ɏ₤Ø_₱ΣŖҠł₡Ø_₦Ʊ₴₮Ø_₥₣_₡ł∆ł_₤ł₦Ø₥₤Ɏ";

    const mapEncodeEncrypted = "eyLihpIgOiLihpEiLCLihpMiOiLihpgiLCLihpkiOiLQkIiwi0YHQtdC70LjQutCwIjoi0YHQsNC50YIiLCLihpYiOiLihp4iLCLihpkiOiLQmSIsIuKGkSI6IuKGkCIiLCLihpYiOiLihpYiLCLihpQiOiLihpMiLCLihpwiOiLQmCIiLCLihp8iOiLQsiIsIuKGkCI6IuKGkSIiLCLihpYiOiLihpAiLCLihp0iOiLQqCIiLCLihqAiOiLQkiIsIuKGlyI6ItChIiwi4oaXIjoi0KYiLCLihqUiOiLQnCIiLCLihqAiOiLQpCIiLCLihqgiOiLQriIsIuKGqiI6ItChIiwi4oarySI6ItCfIiwi4oaqiiI6ItChIiwi4oaPIjoi0JYiLCLihqwiOiLQvCIiLCLihqYiOiLQsiIsIuKGrSI6ItCQIiwi4oatlCI6ItCUIiwi4oa4Ijoi0JMiLCLihqYiOiLQqCIiLCLihqIiOiLQsiIsIuKGrCI6ItCgIiwi4oaylSI6ItCUIn0=";
    const mapDecodeEncrypted = "eyLihpAiOiLihpIiLCLihpMiOiLihpEiLCJCSiI6IuKGkiIsIuKGkyI6IuKGkSIiLCJtIjoi0KYiLCJqIjoi0LQiLCJhIjoi0LkiLCLihp4iOiLihpkiLCJyIjoi0LciLCJzaCI6IuKGkyIsImoiOiLihpYiLCJmIjoi0LMiLCJjIjoi0LwiLCJ0Ijoi0LciLCJpIjoi0LoiLCLihpAiOiLihpgiLCJwIjoi0LQiLCJ4Ijoi0LgiLCJjaCI6ItCIIiwiZyI6ItCUIiwiayI6ItCjIiwiSCI6ItCWIiwicSI6ItCyIiwiZCI6ItCEIiwi0LIiOiLQqSIiLCJ1Ijoi0JkiLCLQpyI6ItCxIn0=";

    let mapEncode = null;
    let mapDecode = null;

    function checkAccess() {
      const user = document.getElementById('username').value.trim();
      const pass = document.getElementById('password').value.trim();

      if (user === revealStr(encLogin) && pass === revealStr(encPass)) {
        document.getElementById('loginArea').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        mapEncode = reveal(mapEncodeEncrypted);
        mapDecode = reveal(mapDecodeEncrypted);
      } else {
        document.getElementById('error').classList.remove('hidden');
      }
    }

    function transform(text, map) {
      return [...text].map(char => {
        const lower = char.toLowerCase();
        const mapped = map[lower] || char;
        return char === lower ? mapped : mapped.toUpperCase();
      }).join('');
    }

    function typeText(element, text, delay = 30) {
      element.textContent = '';
      let i = 0;
      (function type() {
        if (i < text.length) {
          element.textContent += text[i++];
          setTimeout(type, delay);
        }
      })();
    }

    function encode() {
      const input = document.getElementById('inputText').value;
      const output = transform(input, mapEncode);
      typeText(document.getElementById('outputText'), output);
    }

    function decode() {
      const input = document.getElementById('inputText').value;
      const output = transform(input, mapDecode);
      typeText(document.getElementById('outputText'), output);
    }
  </script>
</body>
</html>
